% !TeX root = ../solution.tex

\hypertarget{he22.25}{%
\chapter{%
	\texorpdfstring{[HE22.25] {\NotoJapan è‡ªå‹•è²©å£²æ©Ÿ}}%
	{[HE22.25] }}%
	\label{he22.25}}

\begin{marginfigure}
	\includegraphics[width=49mm]{level6/challenge25.jpg}
\end{marginfigure}
\section{Intro}
I like these Japanese vending machines! {\NotoThai à¹‘}({\NotoSymbolTwo â—•}
â€¿{\NotoSymbolTwo â—•}){\NotoThai à¹‘}

\noindent
If I could just get a {\NotoEmoji ğŸš©}...

\noindent
http://46.101.107.117:2210

\noindent
Note: The service is restarted every hour at x:00.

\section{Hint}
{\NotoJapan ç¶™æ‰¿} -- inheritance

\section{Solution}\label{hv22.25solution}

First translate all the labels from Japanese to English

\begin{fullwidth}
\begin{tabular}{p{.6\textwidth}p{.6\textwidth}}
{\NotoJapan ç¶™æ‰¿} & Inheritance \\
{\NotoJapan ã‚ãªãŸã®é¸æŠã‚’ã—ã¦ãã ã•ã„}! & Make your choice! \\
{\NotoJapan è‡ªå‹•è²©å£²æ©Ÿ} & vending machine \\
{\NotoJapan ãŠæ¥½ã—ã¿ãã ã•ã„} {\NotoEmoji ğŸ§ƒ}! & Enjoy {\NotoEmoji ğŸ§ƒ}! \\
{\NotoJapan é¸ã¶} & Choose\\
\end{tabular}
\end{fullwidth}

\noindent
Playing around with Postman triggers these messages:
\begin{fullwidth}
\begin{tabular}{p{.6\textwidth}p{.6\textwidth}}
{\NotoJapan é †åºãŒç„¡åŠ¹ã§ã™} & The order is invalid \\
{\NotoJapan é‡‘é¡ã¯1ã‹ã‚‰4ã®é–“ã§ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“} & The amount must be between 1 and 4 \\
{\NotoJapan ã‚¢ã‚¤ãƒ†ãƒ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“} & Item not found \\
{\NotoEmojiğŸš©}{\NotoJapan ã¯è¨±å¯ã•ã‚Œã¦ã„ã¾ã›ã‚“} & {\NotoEmojiğŸš©} is not allowed \\
\end{tabular}
\end{fullwidth}

\noindent 
The application simulates a vending machine that offers several different items, but does reject the flag  {\NotoEmoji ğŸš©}.  Very likely we have to try to get the vending machine to deliver a flag.  The delivery is triggered by PUT request with JSON data, such as 
{\texttt "amount":"4","item":"{\NotoEmoji ğŸ©}"}.  Probably replacing the doughnut  {\NotoEmoji ğŸ©} with a flag should give the flag.

The hint points at JavaScript inheritance and a helpful tip on Discord was ``have a pro to type it in'' which points towards prototype poisoning.  After some playing around, changing the JSON to {\texttt \{"\_\_proto\_\_": \{"item": "{\NotoEmoji ğŸš©}"\}, "amount":"1" \} } does yield the desired result {\NotoJapan  ãŠæ¥½ã—ã¿ãã ã•ã„} {\NotoEmoji ğŸš©}{\texttt : he2022\{p0llut10n\_41nt\_g00d\} }

\subsection{Notes}
\href{https://www.fastify.io/docs/latest/Guides/Prototype-Poisoning/}{Prototype-Poisoning}




	









