= è‡ªå‹•è²©å£²æ©Ÿ

image::level6/challenge25.jpg[,300,float="right"]
== Intro
I like these Japanese vending machines! à¹‘(â—•â€¿â—•)à¹‘

If I could just get a ğŸš©...

http://46.101.107.117:2210

Note: The service is restarted every hour at x:00.

=== Hint
ç¶™æ‰¿ -- inheritance

== Solution

First translate all the labels from Japanese to English

[cols="1,1"]
|===
| ç¶™æ‰¿
| Inheritance 

| ã‚ãªãŸã®é¸æŠã‚’ã—ã¦ãã ã•ã„! 
| Make your choice! 

| è‡ªå‹•è²©å£²æ©Ÿ 
| vending machine 

| ãŠæ¥½ã—ã¿ãã ã•ã„ğŸ§ƒ! 
| Enjoy ğŸ§ƒ! 

| é¸ã¶
| Choose
|===

Playing around with Postman triggers these messages:
[cols="1,1"]
|===
|é †åºãŒç„¡åŠ¹ã§ã™
|The order is invalid 

|é‡‘é¡ã¯1ã‹ã‚‰4ã®é–“ã§ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“
|The amount must be between 1 and 4 

|ã‚¢ã‚¤ãƒ†ãƒ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“
|Item not found 

|ğŸš©ã¯è¨±å¯ã•ã‚Œã¦ã„ã¾ã›ã‚“
|ğŸš©is not allowed 
|===

The application simulates a vending machine that offers several different
items, but does reject the flag  ğŸš©.  Very likely we have to try to get the
vending machine to deliver a flag.  The delivery is triggered by PUT request
with JSON data, such as `{ "amount":"4","item":"ğŸ©"}`.  Probably replacing the
doughnut ğŸ© with a flag should give the flag.

The hint points at JavaScript inheritance and a helpful tip on Discord was
`have a pro to type it in` which points towards prototype poisoning.  After
some playing around, changing the JSON to `{ {"__proto__": {"item":
"ğŸš©"}, "amount":"1" } }` does yield the desired result
`{ ãŠæ¥½ã—ã¿ãã ã•ã„ ğŸš© : he2022{p0llut10n_41nt_g00d} }`

=== Notes
https://www.fastify.io/docs/latest/Guides/Prototype-Poisoning/
