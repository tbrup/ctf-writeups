= [HE23.06] Chemical Code

image::level3/challenge6.jpg[,300,float="right"]

== Intro
Our crazy chemistry professor wrote a secret code on the blackboard:

  9 57 32 10 111 39 85 8 115 8 16 42 16

He also mumbled something like "essential and elementary knowledge".

=== ðŸš© Flag

*   lowercase only, no spaces
*   wrap into ``he2023{`` and ``}``
*   example: ``he2023{exampleflagonly}``

== Solution
Use a periodoc table of elements to assign the element name to element number:

  9 57 32 10 111 39 85 8 115 8 16 42 16
  F La Ge Ne Rg  Y  At O Mc  O S  Mo S


  he2023{flagenergyatomcosmos}

= [HE23.07] Serving Things

image::level3/challenge7.jpg[,300,float="right"]

== Intro
Get the ðŸš© at /flag.

http://ch.hackyeaster.com:2316

Note: The service is restarted every hour at x:00.

== Solution
The site presents us with the possibility to get some quotes or wise sayings.
One of the options is to get a flag, but then we are greeted with ``Thank you
hacker! But our flag is in another castle! ~ Bugs Bunny``.  Inspecting the
request, we see http://ch.hackyeaster.com:2316/get?url=http://flags:1337/flag.
Playing around a bit, we find that calling
http://ch.hackyeaster.com:2316/get?url=file:///flag does return the flag
``he2023{4ls0-53rv3r-c4n-b3-1nj3ct3d!!!}``

= [HE23.08] Cut Off

image::level3/challenge8.jpg[,300,float="right"]

== Intro

I had a secret Easter egg on my screenshot, but I cropped it, hehe!

Kudos to former Hacky Easter winner _Retr0id_ - he's one of the researches who
found the vulnerability in question!


image::level3/screenshot.png[,600]


== Solution

The hint leads us to CVE-2023-21036 and a description of it at
https://arstechnica.com/gadgets/2023/03/google-pixel-bug-lets-you-uncrop-the-last-four-years-of-screenshots/.
Using https://acropalypse.app/, the screenshot can be uncropped

image::level3/uncropped.png[,300,]
image::level3/egg08.png[,300,]

to reveal the QR code with the flag ``he2023{4cr0pa_wh4t?}``


= [HE23.09] Global Egg Delivery

image::level3/challenge9.jpg[,300,float="right"]

== Intro

Thumper has taken great strides with the digitization of the business of
distributing eggs and assorted goodies. Globalizing such a service is not
without its pains and requires the additional effort to account for local
customs.

Now Thumper has his message all prepared, fed through a block-chain enabled,
micro-service driven, AI enhanced, zero trust translation service all that
comes back is this...

Can you help Thumper decode the message?

== Solution
The message consists of many short UTF-16 strings with BOM, switching between
little and big endian code.  Decode it using python to get the flag

[source, python]
----
import codecs

encodings=['utf-16-le', 'utf-16-be']
boms = [codecs.BOM_UTF16_LE, codecs.BOM_UTF16_BE]

with open('message.txt', 'rb') as inF:
    msg = inF.read()
    chars = msg.split(b'\xff\xfe')
    for c in chars:
        cs = c.split(b'\xfe\xff')
        if len(cs) > 1:
            print(f"{cs[0].decode(encodings[0])}{cs[1].decode(encodings[1])}",end='')
    print()
----

  he2023{u7Æ’_b0m5s_8rá—±_n07_8ã…£way5_1gn0rá—±d}
