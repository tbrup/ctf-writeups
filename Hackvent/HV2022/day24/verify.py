"""
Welcome to Santas Signing Session

modulus: n = 0xaee44d4856fa64e34836df6d167f61447b3ee74734d08adaf48ce40fc91be630e0acaa5db1e185c05c20507955230cc42a15e2c4bea72d9cd416cc8601287369408f2e9db43e85c6e1c29e96b10a56435cc65efda97cc114a7b6c42567ec5567
exponent: e = 0x10001
prime: p = 0xd4c10f30e9f18c4acf20840f0e6b8ad9a79df11f...
Santa has 75000000000 energy remaining. Don't over-tax santa

Do you want an autograph before you pick up your flag? [yN]
y
What's your name for the autograph?
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
Here is your autograph: 1ca2b3c8a9f1a50d1823157e574d7791ebbb6a501b15fd82fa99780c43553a4b8eecd9ccac15fb88084f6009cf16f8cabd7cf9bcf8f92df009682c4526f2d7a7dc5a452e1e3b33c349addb024c77ac7cd025c4c7befe13a328a02e6693fd4646
Santa has 74989495279 energy remaining. Don't over-tax santa
Do you want another autograph? [yN]
y
What's your name for the autograph?
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
Here is your autograph: 609d0df1cae069fcd958fb771288699c43b7ceb8f5f9239c6d791d476aa15c072b1f2b5348c8b9d43d362deb73b7eb8548aac70ce4f58c0e3c945be334b81e790d45e119ca89c3c4abc3b08ee89a350f3187e70aec5f32734bbbc5d36699ff14
Santa has 74979009394 energy remaining. Don't over-tax santa
Do you want another autograph? [yN]
y
What's your name for the autograph?
a
Here is your autograph: 08165ce823355d5dcc2483a8939b32e8594099d52ec12807419e637291179061059307cc7f67d4112270bef57b1b2f4290e3709d2cbe524ea638e54f4d8d7731bac6d25cd2c48fbdf0ad0b94d00222262fc47db92aeab3bc71cea417c2e20486
Santa has 74968540105 energy remaining. Don't over-tax santa
Do you want another autograph? [yN]
y
What's your name for the autograph?
aa
Here is your autograph: 0de42d9610135ce532f3e660e85aee69c14871c3108a37b3fbe660160a77d54b510903aecd71010bac9750eb2c5d807fc11145041e806bf51ba89ca48514dfaccd582a45767313e33cc26f98c0500996a3049a3b35e43a651e9a3011ce6f5d94
Santa has 74958071830 energy remaining. Don't over-tax santa
Do you want another autograph? [yN]
y
What's your name for the autograph?
aaa
Here is your autograph: 0362516e7c87eef20eafb4ba38aaf6b6f581a88d565eabc3c1f90591ab6c0dc62125cb5852292bc642187973b5b31cb8d6b4296de3ecfc93c3c8e03340e9ec6dec2dda7d260d06f47fdf4d2527d04fe77e288b52281b6d0e454e36a1f1e25a07
Santa has 74947587249 energy remaining. Don't over-tax santa
Do you want another autograph? [yN]
y
What's your name for the autograph?
aaaa
Here is your autograph: 7e04013d387ce5c18d7f8312c788f246f7f90814972eceb5f55435e7dab21d8a6f2f09acd21e336a515d42bbb07995ae45b4efd130cc3d8ab1104aa68ce78e0bdfaa9256cfd3dc1ab81241386f5dd800a32f2fac3ddfe6c94882909995d93e4d
Santa has 74937110576 energy remaining. Don't over-tax santa
Do you want another autograph? [yN]
n
And here is your flag: 9f9f7fc8ea6c62278dc1ac440717fcacbedc2b42d60cddbf99372e38a29b4ecdaa03d0961a00a0f1a4d0b39e2acd201dc7b27c857939308e082cc475a0f3b594b8c41f972e4b74384e7fd0e1eda54e4d76341f2780d86fb3c28df952bbafd22c
Have a nice day!
"""


n = 0xf34a2666a4732241e753f2bd76c4579e154773543f5367bb473e297f976cfb465755e2d6d162647ee486adf9369685c01e19be4b24824bffbd66bb7bfa758f31487590619b7feb54b6ed59aed5f9767a02b5678200aea77547e5289a7b33b585
e = 0x10001
sigs = {
'01000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000':
0x362fc3ecdfd546259fe00e10ba51b5d5a4f51fad63a95925f7b4122dada18d6bc877b66f753c4b042d2c90df37b4e322eab280c50d115b543cc9848a70d7ff44bcf26748ee7d09e240fca709b3c40e79a1f3352b9f38d955738255ae9f9a1233,
    '10000000000000000000000000000000000000000000000':
0xc0ea01feff2e5d8bb2865c8860d286a4a48b8f85480ae5992dbb69cfc4125cfc7eec8789ea54883526946cf9381345731e8e558bb8c40cde3423dfe27b03ce8d2581c97333e2cee3de3f8ff217bc6a9d8b503d9b20957241dfc1ac99ee1d439f,
    '1000000000000000000000000': 0x80356cb2bce2e444b7f3320caa9b9220780fec2f157909b40b75e71b55626533d3d020c73f535d622a6596c05f1546e9e4b8be9f2d58aef567481b0ba17da167f870bb7285dbcb207367a476a004c228468b939af0c149b65e83e0dc8f711adb,
    '1000000000000':0xabe7f6f852b69549a496a2bc0c9aabaa28a20f40d11816eee7e19a0d91c94eb0f20c493cae91d26a234658b697522ac9b4767cd759060c398ec28ea86b6a588f2d98b5dbc69ca2984337a4c1a5cd704c4d1af3e612fbde3a682d1e2cfaee799f,
    '0x1000000000000':0x39c50653a804f2c8edd72d284e5e0dfb5e29cd51310400741f6f79f1e70edfd172b1c85d86f88ef937c551e5e3a074191b33471d1887fe26580701e08ead458a2a7928714423f18caf4d6f12e8972368eb3bb1bae5007c24c8ae2a9990a42277
}


n = 0xc9dea750908f77b0bc5beec59b9eddb205d413a184596c436c65e014a0debcbd28fd0abad64e2ba7d7883b80b7615aaab9a67157448f494912a784cb9fcc0002239d2cee14b0f85e18bb664e5d4b4e094af0ce075e0a8579fc50766024df5b59
sigs = { 'zzz':
0x75bbb1a75f3f5db54b16fa407a27306b8f8bae3fa9ee69a669c464a5385fddddbc87244051ab22edc6642e77b15f4d183ffabcc1bcd4e2f2f1d040bc673be3e1daec926a6ce35f619fe711b88656bb5106b6da220c3d78075cb27682cfe9c4d5,
        'zyx': 0xc9766ed8135f33eaaf9494682e52a2d491bd4b7bab16df86e47a1215d725aa59e5e5f4394e6f71d4d3034d46f7ddff5fab3be74eb221eabbaa29856f3b08c8c380e5226d8034ed4181fcd12ceac339b94eeccbfa7b9266af6a8d138c8a40c324
        }
import binascii
from gmpy2 import mpz
import math


# Function to calculate k for given a, b, m
def discreteLogarithm(a, b, m):
    n = int(math.sqrt(m) + 1)
    value = [0] * m

    # Store all values of a^(n*i) of LHS
    for i in range(n, 0, -1):
        value[pow(a, i * n, m)] = i

    for j in range(n):
        # Calculate (a ^ j) * b and check
        # for collision
        cur = (pow(a, j, m) * b) % m

        # If collision occurs i.e., LHS = RHS
        if (value[cur]):
            ans = value[cur] * n - j
            # Check whether ans lies below m or not
            if (ans < m):
                return ans
    return -1


for key in sigs:
    orig = pow(mpz(sigs[key]), e, n)
    print(key, hex(orig))
    print(type(orig))
    while orig > 0:
        tmp = orig % 0x100
        if tmp >0x20 and tmp < 127:
            print(chr(tmp), end='')
        else:
            print(' ', end='')
        orig //= 0x100
    print()

m = 0x10001000

last = 1
for d in range(15):
    s = pow(m, d, n)
    print(f'{m:x} : {s:x}')
    print(f'{pow(m,d):x}')
    print(f'{n:x}')
    print(f'{pow(m,d)//n:x}')
    last = pow(m, d)
    # for i in range(1024):
    #     guess = math.log(s)/math.log(m)
    #     s +=  n
    #
    #     if guess % 1 < 0.02 or guess % 1 > 0.98:
    #         print(f'guessed d: {i} {guess}')
    #         break
